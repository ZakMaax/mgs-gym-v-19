<templates xml:space="preserve">
    <t t-name="mgs_gym.Dashboard">
        <div class="o_mgs_gym_dashboard container-fluid p-4">
            <div class="d-sm-flex align-items-center justify-content-between mb-4">
                <h1 class="display-5 mb-0 text-primary fw-bold">
                    <i class="fa fa-dumbbell me-2 text-primary"></i>
                    Gym Analytics Dashboard
                </h1>
            </div>


        <div class="row g-3">
            <t t-if="state.data">
                <t t-foreach="[
                { 'label': 'Active Memberships', 'value': state.data.active, 'icon': 'users', 'color': '#0d6efd', 'click': 'openActiveMembershipsView' },
                { 'label': 'Expired', 'value': state.data.expired, 'icon': 'goal-expiry', 'color': '#dc3545', 'click': 'openExpiredMembershipsView' },
                { 'label': 'Suspended', 'value': state.data.suspended, 'icon': 'ban', 'color': '#ffc107', 'click': 'openSuspendedMembershipsView' },
                { 'label': 'About to Expire (7 days)', 'value': state.data.about_to_expire, 'icon': 'time', 'color': '#198754', 'click': 'openAboutToExpireView' }
                ]" t-as="card" t-key="card.label">
                    <div class="col-md-3 col-sm-6">
                        <div class="hovering card metric-card shadow-sm h-100" t-att-style="'border-top: 5px solid ' + card.color"  t-on-click="() => this[card.click]()">
                            <div class="card-body d-flex align-items-center">
                                <div class="metric-icon me-3">
                                <div class="metric-icon-bg">
                                <img t-att-src="'/mgs_gym/static/src/icons/' + card.icon + '.svg'" t-att-alt="card.label"/>
                                </div>
                                </div>
                                <div>
                                <div class="fw-light fs-4"> <t t-esc="card.label"/> </div>
                                <div class="metric-value fw-bold"> <t t-esc="card.value"/> </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </t>
            </t>
        <t t-else="">
        <p>Loading dashboard data...</p>
        </t>
        </div>


    <hr class="my-4"/>


        <div class="row g-4">
            <div class="col-lg-4 col-md-6">
                <div class="card h-100 shadow-sm chart-card">
                <div class="card-header bg-success fw-semibold text-white">Memberships by Branch</div>
                <div class="card-body chart-container">
                <canvas id="gymBranchPie"></canvas>
                </div>
                </div>
            </div>
            <div class="col-lg-4 col-md-6">
                <div class="card h-100 shadow-sm chart-card">
                <div class="card-header bg-success fw-semibold text-white">By Gender</div>
                <div class="card-body chart-container">
                <canvas id="gymGenderPie"></canvas>
            </div>
                </div>
            </div>
                <div class="col-lg-4 col-md-6">
                <div class="card h-100 shadow-sm chart-card">
                <div class="card-header bg-success fw-semibold text-white">By Recurrence Unit</div>
                <div class="card-body chart-container">
                <canvas id="gymRecurrencePie"></canvas>
                </div>
                </div>
            </div>
        </div>

        <!-- Line graphs -->

            <div class="row mt-4">
                <div class="col-lg-6 mb-4">
                    <div class="card h-100 shadow-sm">
                        <div class="card-header bg-primary text-white">
                            <strong>New Memberships Over Time</strong>
                        </div>
                        <div class="card-body" style="min-height:300px;">
                            <canvas id="gymTimelineLine"></canvas>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6 mb-4">
                    <div class="card h-100 shadow-sm">
                        <div class="card-header bg-primary text-white">
                            <strong>Monthly Revenue (posted invoices)</strong>
                        </div>
                        <div class="card-body" style="min-height:300px;">
                            <canvas id="gymRevenueLine"></canvas>
                        </div>
                    </div>
                </div>
            </div>
    </div>
    </t>
</templates>